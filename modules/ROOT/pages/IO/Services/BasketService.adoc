:table-caption!:
:example-caption!:
:source-highlighter: prettify
:sectids!:
[[io__basketservice]]
= BasketService

This service class contains various methods used for manipulating the customers basket. +
All public functions are available in the Twig template renderer.



===== Namespace

`IO\Services`





.Properties
|===
|Type |Name |Description

|xref:stable7@interface::Basket.adoc#basket_contracts_basketitemrepositorycontract[`BasketItemRepositoryContract`]
a|`$basketItemRepository`
|This repository is used to manipulate basketItems|xref:stable7@interface::Basket.adoc#basket_contracts_basketrepositorycontract[`BasketRepositoryContract`]
a|`$basketRepository`
|This repository is used to manipulate the customers basket|xref:stable7@interface::Frontend.adoc#frontend_contracts_checkout[`Checkout`]
a|`$checkout`
|This service is used to manipulate the checkout|xref:stable7@interface::Frontend.adoc#frontend_services_vatservice[`VatService`]
a|`$vatService`
|This service provides methods for VAT related tasks|xref:stable7@interface::Webshop.adoc#webshop_contracts_contactrepositorycontract[`ContactRepositoryContract`]
a|`$contactRepository`
|This repository is used to manipulate Contacts|xref:IO/Services/CouponService.adoc#[`CouponService`]
a|`$couponService`
|This service provides functionality related to coupons|xref:stable7@interface::Webshop.adoc#webshop_contracts_webstoreconfigurationrepositorycontract[`WebstoreConfigurationRepositoryContract`]
a|`$webstoreConfigurationRepository`
|This repository is used to read webstore configuration|xref:stable7@interface::Webshop.adoc#webshop_contracts_sessionstoragerepositorycontract[`SessionStorageRepositoryContract`]
a|`$sessionStorageRepository`
|This repository is used to read and write data of the session|link:http://php.net/array[`array`^]
a|`$basketItems`
|Contains all current BasketItems|link:http://php.net/string[`string`^]
a|`$template`
|Unused property

    
*Deprecated*|link:http://php.net/string[`string`^]
a|`$pluginNamespace`
|
|===


===== Methods

[source%nowrap, php, subs=+macros]
[#__construct]
----

public __construct($basketItemRepository, $checkout, $vatService, $contactRepository, $basketRepository, $vatInitService, $couponService, $webstoreConfigurationRepository, $sessionStorageRepository)

----





BasketService constructor.

.*Parameters*
|===
|Type |Name |Description
|xref:stable7@interface::Basket.adoc#basket_contracts_basketitemrepositorycontract[`BasketItemRepositoryContract`]
a|`$basketItemRepository`
|

|xref:stable7@interface::Frontend.adoc#frontend_contracts_checkout[`Checkout`]
a|`$checkout`
|

|xref:stable7@interface::Frontend.adoc#frontend_services_vatservice[`VatService`]
a|`$vatService`
|

|xref:stable7@interface::Webshop.adoc#webshop_contracts_contactrepositorycontract[`ContactRepositoryContract`]
a|`$contactRepository`
|

|xref:stable7@interface::Basket.adoc#basket_contracts_basketrepositorycontract[`BasketRepositoryContract`]
a|`$basketRepository`
|

|xref:stable7@interface::Accounting.adoc#accounting_contracts_vatinitcontract[`VatInitContract`]
a|`$vatInitService`
|

|xref:IO/Services/CouponService.adoc#[`CouponService`]
a|`$couponService`
|

|xref:stable7@interface::Webshop.adoc#webshop_contracts_webstoreconfigurationrepositorycontract[`WebstoreConfigurationRepositoryContract`]
a|`$webstoreConfigurationRepository`
|

|xref:stable7@interface::Webshop.adoc#webshop_contracts_sessionstoragerepositorycontract[`SessionStorageRepositoryContract`]
a|`$sessionStorageRepository`
|
|===


[source%nowrap, php, subs=+macros]
[#settemplate]
----

public setTemplate($template)

----

[WARNING]
.Deprecated! 
====

This method will not be supported in the future. Please refrain from using it as soon as possible.

====




Set the template property. Different templates need different data.

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$template`
|
|===


[source%nowrap, php, subs=+macros]
[#getbasketfortemplate]
----

public getBasketForTemplate():link:http://php.net/array[array^]

----





Gets the basket object with relevant data for the template renderer

[source%nowrap, php, subs=+macros]
[#getbasket]
----

public getBasket():xref:stable7@interface::Basket.adoc#basket_models_basket[Basket]

----





Return the basket model

[source%nowrap, php, subs=+macros]
[#gettotalvats]
----

public getTotalVats():link:http://php.net/array[array^]

----





Gets all VATs applied to the basket

[source%nowrap, php, subs=+macros]
[#getbasketquantity]
----

public getBasketQuantity():link:http://php.net/float[float^] \| link:http://php.net/int[int^]

----





Gets the total quantity of all basket items.

[source%nowrap, php, subs=+macros]
[#getbasketitems]
----

public getBasketItems():link:http://php.net/array[array^]

----





List the basket items

[source%nowrap, php, subs=+macros]
[#getbasketitemsfororder]
----

public getBasketItemsForOrder():link:http://php.net/array[array^]

----





List the basket items for order

[source%nowrap, php, subs=+macros]
[#getbasketitemsfortemplate]
----

public getBasketItemsForTemplate($template = &quot;&quot;, $appendItemData = true):link:http://php.net/array[array^]

----





Get basket items with all relevant data for the template renderer.

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$template`
|Unused parameter (legacy purposes)

|link:http://php.net/bool[`bool`^]
a|`$appendItemData`
|Flag for adding item data to the basket items
|===


[source%nowrap, php, subs=+macros]
[#checkbasketitemslang]
----

public checkBasketItemsLang($language = &quot;&quot;)

----





Remove basket items not having a valid language for the current basket configuration.

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$language`
|The language in format ISO-639-1
|===


[source%nowrap, php, subs=+macros]
[#checkbasketitemscurrency]
----

public checkBasketItemsCurrency()

----

[WARNING]
.Deprecated! 
====

Use checkBasketItemsByPrice instead

====




Remove basket items not having a valid price for the current basket configuration (referrer, currency,.

[source%nowrap, php, subs=+macros]
[#checkbasketitemsbyprice]
----

public checkBasketItemsByPrice():link:http://php.net/int[int^]

----





Remove basket items not having a valid price for the current basket configuration (referrer, currency,.

[source%nowrap, php, subs=+macros]
[#getbasketitem]
----

public getBasketItem($basketItemId, $appendVariation = true):link:http://php.net/array[array^]

----





Get a basket item

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/int[`int`^] \| xref:stable7@interface::Basket.adoc#basket_models_basketitem[`BasketItem`]
a|`$basketItemId`
|The unique id of the basketItem

|link:http://php.net/bool[`bool`^]
a|`$appendVariation`
|Flag for appending itemData to the BasketItem
|===


[source%nowrap, php, subs=+macros]
[#addbasketitem]
----

public addBasketItem($data):link:http://php.net/array[array^]

----





Add an item to the basket or update the basket

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/array[`array`^]
a|`$data`
|Contains the basket item
|===


[source%nowrap, php, subs=+macros]
[#updatebasketitem]
----

public updateBasketItem($basketItemId, $data):link:http://php.net/array[array^]

----





Update a basket item

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/int[`int`^]
a|`$basketItemId`
|The unique id of the basket item

|link:http://php.net/array[`array`^]
a|`$data`
|Contains the updated basket item
|===


[source%nowrap, php, subs=+macros]
[#deletebasketitem]
----

public deleteBasketItem($basketItemId)

----





Delete an item from the basket

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/int[`int`^]
a|`$basketItemId`
|The unique id of the basketItem
|===


[source%nowrap, php, subs=+macros]
[#findexistingonebydata]
----

public findExistingOneByData($data):xref:stable7@interface::Basket.adoc#basket_models_basketitem[BasketItem]

----





Check whether the item is already in the basket

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/array[`array`^]
a|`$data`
|Contains the basket item to search for
|===


[source%nowrap, php, subs=+macros]
[#resetbasket]
----

public resetBasket()

----





Reset basket after execute payment / order created

[source%nowrap, php, subs=+macros]
[#setbillingaddressid]
----

public setBillingAddressId($billingAddressId)

----





Set the billing address id

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/int[`int`^]
a|`$billingAddressId`
|
|===


[source%nowrap, php, subs=+macros]
[#getbillingaddressid]
----

public getBillingAddressId():link:http://php.net/int[int^]

----





Return the billing address id

[source%nowrap, php, subs=+macros]
[#setdeliveryaddressid]
----

public setDeliveryAddressId($deliveryAddressId)

----





Set the delivery address id

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/int[`int`^]
a|`$deliveryAddressId`
|
|===


[source%nowrap, php, subs=+macros]
[#getdeliveryaddressid]
----

public getDeliveryAddressId():link:http://php.net/int[int^]

----





Return the delivery address id

[source%nowrap, php, subs=+macros]
[#getmaxvatvalue]
----

public getMaxVatValue():link:http://php.net/float[float^]

----





Get the maximum vat value in basket.

