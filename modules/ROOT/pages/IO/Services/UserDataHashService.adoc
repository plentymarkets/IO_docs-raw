:table-caption!:
:example-caption!:
:source-highlighter: prettify
:sectids!:
[[io__userdatahashservice]]
= UserDataHashService

This service class contains functions related to hashing and data storage. +
All public functions are available from the Twig template renderer.



===== Namespace

`IO\Services`





.Properties
|===
|Type |Name |Description

|xref:stable7@interface::Plugin.adoc#plugin_contracts_database[`DataBase`]
a|`$db`
||         xref:5.0.0@plugin-::.adoc#[``]
a|`$defaultTTL`
|
|===


===== Methods

[source%nowrap, php, subs=+macros]
[#__construct]
----

public __construct($dataBase, $templateConfigService)

----





UserDataHashService constructor.

.*Parameters*
|===
|Type |Name |Description
|xref:stable7@interface::Plugin.adoc#plugin_contracts_database[`DataBase`]
a|`$dataBase`
|

|xref:IO/Services/TemplateConfigService.adoc#[`TemplateConfigService`]
a|`$templateConfigService`
|
|===


[source%nowrap, php, subs=+macros]
[#find]
----

public find($hash, $contactId = null, $plentyId = null):xref:IO/DBModels/UserDataHash.adoc#[UserDataHash]

----





Get entry by hash if exists

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$hash`
|The hash to search an entry for

|link:http://php.net/int[`int`^]
a|`$contactId`
|Optional: Restrict results to a contact id. Otherwise use logged in contact

|link:http://php.net/int[`int`^]
a|`$plentyId`
|Optional: Use a specific plentyId. Otherwise use id of current client.
|===


[source%nowrap, php, subs=+macros]
[#findhash]
----

public findHash($type, $contactId = null, $plentyId = null):link:http://php.net/string[string^]

----





Get the hash of a specific type if exists and is not expired.

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$type`
|The type to get the hash for

|link:http://php.net/int[`int`^]
a|`$contactId`
|Optional: Restrict results to a contact id. Otherwise use logged in contact

|link:http://php.net/int[`int`^]
a|`$plentyId`
|Optional: Use a specific plentyId. Otherwise use id of current client.
|===


[source%nowrap, php, subs=+macros]
[#getdata]
----

public getData($hash, $contactId = null, $plentyId = null):link:http://php.net/mixed[mixed^]

----





Get the decoded data assigned to a hash

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$hash`
|The hash to search an entry for

|link:http://php.net/int[`int`^]
a|`$contactId`
|Optional: Restrict results to a contact id. Otherwise use logged in contact

|link:http://php.net/int[`int`^]
a|`$plentyId`
|Optional: Use a specific plentyId. Otherwise use id of current client.
|===


[source%nowrap, php, subs=+macros]
[#create]
----

public create($data, $type, $ttl = null, $contactId = null, $plentyId = null):xref:IO/DBModels/UserDataHash.adoc#[UserDataHash]

----





Create a new entry and assign data to the hash for later usage.

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/mixed[`mixed`^]
a|`$data`
|The data to assign to the generated hash entry

|link:http://php.net/string[`string`^]
a|`$type`
|The type of the entry

|link:http://php.net/int[`int`^]
a|`$ttl`
|Optional: Lifetime of the hash entry in hours. Will get the value from config if not defined.

|link:http://php.net/int[`int`^]
a|`$contactId`
|Optional: Restrict results to a contact id. Otherwise use logged in contact

|link:http://php.net/int[`int`^]
a|`$plentyId`
|Optional: Use a specific plentyId. Otherwise use id of current client.
|===


[source%nowrap, php, subs=+macros]
[#delete]
----

public delete($hash, $contactId = null, $plentyId = null):link:http://php.net/bool[bool^]

----





Remove a hash entry if exists.

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$hash`
|The hash to search an entry for

|link:http://php.net/int[`int`^]
a|`$contactId`
|Optional: Restrict results to a contact id. Otherwise use logged in contact

|link:http://php.net/int[`int`^]
a|`$plentyId`
|Optional: Use a specific plentyId. Otherwise use id of current client.
|===


[source%nowrap, php, subs=+macros]
[#deleteall]
----

public deleteAll($type = null, $contactId = null, $plentyId = null):link:http://php.net/bool[bool^]

----





Delete all entries

.*Parameters*
|===
|Type |Name |Description
|link:http://php.net/string[`string`^]
a|`$type`
|Optional: Delete only entries for a specific type

|link:http://php.net/int[`int`^]
a|`$contactId`
|Optional: Restrict results to a contact id. Otherwise use logged in contact

|link:http://php.net/int[`int`^]
a|`$plentyId`
|Optional: Use a specific plentyId. Otherwise use id of current client.
|===


